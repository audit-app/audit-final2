{
  "openapi": "3.0.0",
  "paths": {
    "/api": {
      "get": {
        "operationId": "AppController_getHello",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "App"
        ]
      }
    },
    "/api/test/success": {
      "get": {
        "operationId": "AppController_testSuccess",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "App"
        ]
      }
    },
    "/api/test/error/400": {
      "get": {
        "operationId": "AppController_testBadRequest",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "App"
        ]
      }
    },
    "/api/test/error/404": {
      "get": {
        "operationId": "AppController_testNotFound",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "App"
        ]
      }
    },
    "/api/test/error/500": {
      "get": {
        "operationId": "AppController_testInternalError",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "App"
        ]
      }
    },
    "/api/test/error/custom": {
      "get": {
        "operationId": "AppController_testCustomError",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "App"
        ]
      }
    },
    "/api/audit-log/{rootId}": {
      "get": {
        "description": "Retorna todos los cambios realizados en una plantilla y sus standards, ordenados por fecha descendente. Incluye información del usuario que realizó cada cambio, el tipo de acción (CREATE, UPDATE, DELETE, etc.) y los cambios específicos realizados.",
        "operationId": "AuditLogController_getHistory",
        "parameters": [
          {
            "name": "rootId",
            "required": true,
            "in": "path",
            "description": "ID del template para obtener su historial completo",
            "schema": {
              "format": "uuid",
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          },
          {
            "name": "limit",
            "required": true,
            "in": "query",
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Historial de auditoría obtenido exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AuditLogEntity"
                  }
                }
              }
            }
          },
          "400": {
            "description": "ID de template inválido"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Obtener historial de auditoría de una plantilla",
        "tags": [
          "audit-log"
        ]
      }
    },
    "/api/auth/login": {
      "post": {
        "operationId": "AuthController_login",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Login exitoso. Puede requerir 2FA si está habilitado.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/LoginResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Credenciales inválidas o usuario inactivo",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "429": {
            "description": "Demasiados intentos fallidos",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Login de usuario",
        "tags": [
          "Auth"
        ]
      }
    },
    "/api/auth/refresh": {
      "post": {
        "operationId": "AuthController_refresh",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Token renovado exitosamente. El refresh token se rota automáticamente en cookie.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/RefreshResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Refresh token inválido, revocado o expirado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Renovar access token (con rotation)",
        "tags": [
          "Auth"
        ]
      }
    },
    "/api/auth/logout": {
      "post": {
        "operationId": "AuthController_logout",
        "parameters": [],
        "responses": {
          "204": {
            "description": "Logout exitoso. Tokens revocados y cookie limpiada.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "description": "No autenticado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Logout de usuario",
        "tags": [
          "Auth"
        ]
      }
    },
    "/api/auth/me": {
      "get": {
        "description": "Retorna la información completa del usuario actual incluyendo datos de su organización y rutas de navegación basadas en sus roles",
        "operationId": "AuthController_getProfile",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Perfil del usuario con navegación",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/UserResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "description": "No autenticado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Usuario no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Obtener perfil del usuario autenticado con navegación",
        "tags": [
          "Auth"
        ]
      }
    },
    "/api/auth/switch-role": {
      "post": {
        "description": "Permite al usuario cambiar entre sus roles asignados. El cambio persiste en todas las sesiones activas y futuros refreshes.",
        "operationId": "AuthController_switchRole",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SwitchRoleDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Rol cambiado exitosamente. Nuevo access token generado.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/SwitchRoleResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "description": "No autenticado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "403": {
            "description": "El usuario no tiene asignado el rol solicitado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Cambiar rol activo del usuario",
        "tags": [
          "Auth"
        ]
      }
    },
    "/api/auth/password/request-reset": {
      "post": {
        "operationId": "PasswordResetController_requestReset",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RequestResetPasswordDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Email enviado con código OTP (si el usuario existe)",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/RequestResetResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "429": {
            "description": "Demasiados intentos desde esta cuenta",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Solicitar reset de contraseña con doble validación",
        "tags": [
          "Password Reset"
        ]
      }
    },
    "/api/auth/password/reset": {
      "post": {
        "operationId": "PasswordResetController_reset",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResetPasswordDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Contraseña actualizada exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Token o código OTP inválido o expirado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Usuario no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Resetear contraseña con doble validación (tokenId + OTP)",
        "tags": [
          "Password Reset"
        ]
      }
    },
    "/api/auth/2fa/verify": {
      "post": {
        "operationId": "TwoFactorController_verify",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Verify2FACodeDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Verificación exitosa. Retorna accessToken en body, refreshToken y trustedDevice en cookies.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/Verify2FAResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Código inválido o token expirado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "429": {
            "description": "Demasiados intentos fallidos",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Verificar código 2FA",
        "tags": [
          "Two-Factor Authentication"
        ]
      }
    },
    "/api/auth/2fa/resend": {
      "post": {
        "description": "Reenvía el MISMO código 2FA por email. NO genera un nuevo código ni tokenId. El usuario debe usar el mismo tokenId que recibió originalmente.",
        "operationId": "TwoFactorController_resend",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Resend2FACodeDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Código 2FA reenviado (mismo código)",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "TokenId inválido o expirado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Usuario no encontrado o sesión 2FA expirada",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "429": {
            "description": "Debe esperar 60 segundos antes de reenviar",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Reenviar código 2FA existente",
        "tags": [
          "Two-Factor Authentication"
        ]
      }
    },
    "/api/auth/sessions": {
      "get": {
        "operationId": "SessionsController_listSessions",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Lista de sesiones activas. La sesión actual se marca con isCurrent=true si hay refresh token en cookie.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/SessionResponseDto"
                          }
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Listar sesiones activas del usuario",
        "tags": [
          "Sessions"
        ]
      },
      "delete": {
        "operationId": "SessionsController_revokeSession",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RevokeSessionDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Sesión revocada exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Sesión no encontrada o ya fue revocada",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Revocar una sesión específica",
        "tags": [
          "Sessions"
        ]
      }
    },
    "/api/auth/sessions/all": {
      "delete": {
        "operationId": "SessionsController_revokeAllSessions",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Todas las sesiones han sido cerradas",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageWithCountResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Revocar todas las sesiones activas",
        "tags": [
          "Sessions"
        ]
      }
    },
    "/api/auth/trusted-devices": {
      "get": {
        "operationId": "TrustedDevicesController_listDevices",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Lista de dispositivos confiables",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/TrustedDeviceResponseDto"
                          }
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Listar dispositivos confiables del usuario",
        "tags": [
          "Trusted Devices"
        ]
      },
      "delete": {
        "operationId": "TrustedDevicesController_revokeDevice",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RevokeDeviceDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Dispositivo confiable revocado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Dispositivo no encontrado o ya fue revocado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Revocar un dispositivo confiable específico",
        "tags": [
          "Trusted Devices"
        ]
      }
    },
    "/api/auth/trusted-devices/all": {
      "delete": {
        "operationId": "TrustedDevicesController_revokeAllDevices",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Todos los dispositivos confiables han sido revocados",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageWithCountResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Revocar todos los dispositivos confiables",
        "tags": [
          "Trusted Devices"
        ]
      }
    },
    "/api/auth/google": {
      "get": {
        "description": "Redirige al usuario a la página de login de Google. Después de autenticarse, Google redirige al callback (/auth/google/callback).",
        "operationId": "GoogleAuthController_googleAuth",
        "parameters": [],
        "responses": {
          "302": {
            "description": "Redirige a Google OAuth"
          }
        },
        "summary": "Iniciar autenticación con Google OAuth",
        "tags": [
          "Google OAuth"
        ]
      }
    },
    "/api/auth/google/callback": {
      "get": {
        "description": "Endpoint de callback al que Google redirige después de la autenticación. Procesa el login, genera tokens JWT y redirige al frontend con el access token o token 2FA.",
        "operationId": "GoogleAuthController_googleAuthRedirect",
        "parameters": [],
        "responses": {
          "302": {
            "description": "Redirige al frontend con access token (si no requiere 2FA) o con tempToken (si requiere 2FA)",
            "headers": {
              "Location": {
                "description": "URL de redirección al frontend",
                "schema": {
                  "type": "string",
                  "example": "https://frontend.com/auth/callback?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                }
              },
              "Set-Cookie": {
                "description": "Cookie HTTP-only con refresh token (si no requiere 2FA)",
                "schema": {
                  "type": "string",
                  "example": "refreshToken=jwt-token; HttpOnly; Secure; SameSite=Strict"
                }
              }
            }
          },
          "401": {
            "description": "Autenticación de Google falló o usuario inactivo"
          }
        },
        "summary": "Callback de Google OAuth",
        "tags": [
          "Google OAuth"
        ]
      }
    },
    "/api/auth/admin/users/{id}/change-email": {
      "post": {
        "description": "Cambia el email del usuario y genera una nueva contraseña temporal. Revoca todas las sesiones activas y envía un welcome email con las nuevas credenciales al nuevo email. CRÍTICO: Solo para administradores. El usuario debe hacer login con la nueva contraseña temporal.",
        "operationId": "UserIdentityController_changeEmail",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChangeUserEmailDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Email cambiado exitosamente. Se envió welcome email con credenciales",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Email cambiado exitosamente. Se envió un email de bienvenida con las nuevas credenciales a nuevo@email.com."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "El nuevo email ya está en uso"
          },
          "404": {
            "description": "Usuario no encontrado"
          }
        },
        "summary": "Cambiar email de usuario (SOLO ADMIN)",
        "tags": [
          "auth-administration"
        ]
      }
    },
    "/api/auth/profile/avatar": {
      "post": {
        "description": "Usuario autenticado sube o reemplaza SU imagen de perfil. Formatos: JPG, PNG, WebP. Tamaño máximo: 2MB. Dimensiones: 800x800px.",
        "operationId": "ProfileController_uploadAvatar",
        "parameters": [],
        "requestBody": {
          "required": true,
          "description": "Subir avatar de usuario (JPG, PNG, WebP)",
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "avatar": {
                    "type": "string",
                    "format": "binary",
                    "description": "Archivo (.jpg, .jpeg, .png, .gif, .webp, .svg)"
                  }
                },
                "required": [
                  "avatar"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Imagen subida exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/UserResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Solicitud incorrecta",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Subir imagen de perfil (self-service)",
        "tags": [
          "auth-profile"
        ]
      },
      "delete": {
        "description": "Usuario autenticado elimina SU imagen de perfil del storage y retorna el usuario actualizado.",
        "operationId": "ProfileController_deleteAvatar",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Imagen eliminada exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/UserResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Solicitud incorrecta",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Eliminar imagen de perfil (self-service)",
        "tags": [
          "auth-profile"
        ]
      }
    },
    "/api/auth/profile/password": {
      "patch": {
        "description": "Usuario autenticado cambia SU contraseña. Requiere contraseña actual para validación. Revoca todas las sesiones activas y dispositivos confiables por seguridad.",
        "operationId": "ProfileController_changePassword",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChangePasswordDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Contraseña actualizada. Sesiones cerradas. Usuario debe volver a iniciar sesión.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Contraseña actualizada exitosamente. Se han cerrado todas las sesiones por seguridad. Deberás volver a iniciar sesión."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Contraseña actual incorrecta o nueva contraseña inválida"
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Cambiar contraseña (self-service)",
        "tags": [
          "auth-profile"
        ]
      }
    },
    "/api/auth/profile/2fa/activate": {
      "patch": {
        "description": "Usuario autenticado activa la autenticación de dos factores en SU cuenta. A partir de ahora, deberá ingresar un código enviado por email al iniciar sesión.",
        "operationId": "ProfileController_activate2fa",
        "parameters": [],
        "responses": {
          "200": {
            "description": "2FA activado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/UserResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Solicitud incorrecta",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Activar 2FA (self-service)",
        "tags": [
          "auth-profile"
        ]
      }
    },
    "/api/auth/profile/2fa/deactivate": {
      "patch": {
        "description": "Usuario autenticado desactiva la autenticación de dos factores en SU cuenta. Ya no se requerirá código de verificación al iniciar sesión.",
        "operationId": "ProfileController_deactivate2fa",
        "parameters": [],
        "responses": {
          "200": {
            "description": "2FA desactivado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/UserResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Solicitud incorrecta",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Desactivar 2FA (self-service)",
        "tags": [
          "auth-profile"
        ]
      }
    },
    "/api/users": {
      "post": {
        "operationId": "UsersController_create",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateUserDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Crea un nuevo usuario con sus datos básicos. La contraseña se hashea automáticamente con bcrypt.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/UserResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "users"
        ]
      },
      "get": {
        "operationId": "UsersController_findAll",
        "parameters": [
          {
            "name": "page",
            "required": false,
            "in": "query",
            "description": "Número de página (empieza en 1)",
            "schema": {
              "minimum": 1,
              "default": 1,
              "example": 1,
              "type": "number"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "description": "Cantidad de registros por página",
            "schema": {
              "minimum": 1,
              "maximum": 500,
              "default": 10,
              "example": 10,
              "type": "number"
            }
          },
          {
            "name": "all",
            "required": false,
            "in": "query",
            "description": "Si es true, devuelve TODOS los registros (ignora page y limit)",
            "schema": {
              "default": false,
              "example": false,
              "type": "boolean"
            }
          },
          {
            "name": "sortBy",
            "required": false,
            "in": "query",
            "description": "Campo por el cual ordenar (Solo uno)",
            "schema": {
              "example": "createdAt",
              "type": "string",
              "enum": [
                "lastNames",
                "email",
                "createdAt",
                "isActive",
                "ci",
                "phone",
                "names",
                "updatedAt"
              ]
            }
          },
          {
            "name": "sortOrder",
            "required": false,
            "in": "query",
            "description": "Dirección del ordenamiento (ascendente o descendente)",
            "schema": {
              "default": "DESC",
              "example": "DESC",
              "type": "string",
              "enum": [
                "ASC",
                "DESC"
              ]
            }
          },
          {
            "name": "isActive",
            "required": false,
            "in": "query",
            "description": "Filtrar por estado activo/inactivo",
            "schema": {
              "example": false,
              "type": "boolean"
            }
          },
          {
            "name": "organizationId",
            "required": false,
            "in": "query",
            "description": "Filtrar usuarios por ID de organización (UUID)",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de recursos obtenida exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/UserResponseDto"
                          }
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "users"
        ]
      }
    },
    "/api/users/{id}": {
      "get": {
        "operationId": "UsersController_findOne",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Recurso encontrado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/UserResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "users"
        ]
      },
      "patch": {
        "operationId": "UsersController_update",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateUserDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Actualiza los datos de un usuario y retorna un mensaje de confirmación. NO actualiza la contraseña (usar endpoint de autenticación).",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "users"
        ]
      },
      "delete": {
        "operationId": "UsersController_remove",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Marca el usuario como eliminado sin borrar sus datos de la base de datos. Retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "users"
        ]
      }
    },
    "/api/users/{id}/upload-image": {
      "post": {
        "description": "Sube o reemplaza la imagen de perfil y retorna el usuario actualizado. Formatos: JPG, PNG, WebP. Tamaño máximo: 2MB. Dimensiones: 512x512px.",
        "operationId": "UsersController_uploadProfileImage",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Subir avatar de usuario (JPG, PNG, WebP)",
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "avatar": {
                    "type": "string",
                    "format": "binary",
                    "description": "Archivo (.jpg, .jpeg, .png, .gif, .webp, .svg)"
                  }
                },
                "required": [
                  "avatar"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Imagen subida exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/UserResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Solicitud incorrecta",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Usuario no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Subir imagen de perfil del usuario",
        "tags": [
          "users"
        ]
      }
    },
    "/api/users/{id}/image": {
      "delete": {
        "description": "Elimina la imagen de perfil del usuario, la remueve del storage y retorna el usuario actualizado.",
        "operationId": "UsersController_deleteProfileImage",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Imagen eliminada exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/UserResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Solicitud incorrecta",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Usuario no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Eliminar imagen de perfil del usuario",
        "tags": [
          "users"
        ]
      }
    },
    "/api/users/{id}/deactivate": {
      "patch": {
        "operationId": "UsersController_deactivate",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Cambia el estado del usuario a SUSPENDED y retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "users"
        ]
      }
    },
    "/api/users/{id}/activate": {
      "patch": {
        "operationId": "UsersController_activate",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Cambia el estado del usuario a ACTIVE y retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "users"
        ]
      }
    },
    "/api/users/{id}/2fa/activate": {
      "patch": {
        "operationId": "UsersController_activate2fa",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Cambia el estado del 2fa de un usuario a ACTIVE y retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "users"
        ]
      }
    },
    "/api/users/{id}/2fa/deactivate": {
      "patch": {
        "operationId": "UsersController_deactivate2fa",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Cambia el estado del 2fa de un usuario a INACTIVE y retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "users"
        ]
      }
    },
    "/api/organizations": {
      "post": {
        "operationId": "OrganizationsController_create",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateOrganizationDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Crea una nueva organización con sus datos básicos. El NIT y nombre deben ser únicos.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/OrganizationResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "organizations"
        ]
      },
      "get": {
        "operationId": "OrganizationsController_findAll",
        "parameters": [
          {
            "name": "page",
            "required": false,
            "in": "query",
            "description": "Número de página (empieza en 1)",
            "schema": {
              "minimum": 1,
              "default": 1,
              "example": 1,
              "type": "number"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "description": "Cantidad de registros por página",
            "schema": {
              "minimum": 1,
              "maximum": 500,
              "default": 10,
              "example": 10,
              "type": "number"
            }
          },
          {
            "name": "all",
            "required": false,
            "in": "query",
            "description": "Si es true, devuelve TODOS los registros (ignora page y limit)",
            "schema": {
              "default": false,
              "example": false,
              "type": "boolean"
            }
          },
          {
            "name": "sortBy",
            "required": false,
            "in": "query",
            "description": "Campo por el cual ordenar los resultados",
            "schema": {
              "example": "createdAt",
              "type": "string"
            }
          },
          {
            "name": "sortOrder",
            "required": false,
            "in": "query",
            "description": "Dirección del ordenamiento (ascendente o descendente)",
            "schema": {
              "default": "DESC",
              "example": "DESC",
              "type": "string",
              "enum": [
                "ASC",
                "DESC"
              ]
            }
          },
          {
            "name": "search",
            "required": false,
            "in": "query",
            "description": "Búsqueda de texto libre en nombre, NIT, descripción o email",
            "schema": {
              "example": "coca cola",
              "type": "string"
            }
          },
          {
            "name": "isActive",
            "required": false,
            "in": "query",
            "description": "Filtrar por estado activo/inactivo",
            "schema": {
              "example": false,
              "type": "boolean"
            }
          },
          {
            "name": "hasLogo",
            "required": false,
            "in": "query",
            "description": "Filtrar organizaciones que tienen logo",
            "schema": {
              "example": true,
              "type": "boolean"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de recursos obtenida exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/OrganizationResponseDto"
                          }
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "organizations"
        ]
      }
    },
    "/api/organizations/{id}": {
      "get": {
        "operationId": "OrganizationsController_findOne",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Recurso encontrado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/OrganizationResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "organizations"
        ]
      },
      "patch": {
        "operationId": "OrganizationsController_update",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateOrganizationDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Actualiza los datos de una organización y retorna un mensaje de confirmación. El NIT y nombre deben ser únicos.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "organizations"
        ]
      },
      "delete": {
        "operationId": "OrganizationsController_remove",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Elimina una organización siempre que no tenga usuarios. Retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "organizations"
        ]
      }
    },
    "/api/organizations/{id}/upload-logo": {
      "post": {
        "operationId": "OrganizationsController_uploadLogo",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Subir logo (JPG, PNG, WebP, SVG)",
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "logo": {
                    "type": "string",
                    "format": "binary",
                    "description": "Archivo (.jpg, .jpeg, .png, .gif, .webp, .svg)"
                  }
                },
                "required": [
                  "logo"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Logo subido exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/OrganizationResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Solicitud incorrecta",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Organización no encontrada",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "organizations"
        ]
      }
    },
    "/api/organizations/{id}/image": {
      "delete": {
        "operationId": "OrganizationsController_deleteProfileImage",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Elimina el logo de una organización y retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Organizacion no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "organizations"
        ]
      }
    },
    "/api/organizations/{id}/deactivate": {
      "patch": {
        "operationId": "OrganizationsController_deactivate",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Cambia el estado de la organización a inactivo junto con todos sus usuarios. Retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "organizations"
        ]
      }
    },
    "/api/organizations/{id}/activate": {
      "patch": {
        "operationId": "OrganizationsController_activate",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Cambia el estado de la organización a activo y retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "organizations"
        ]
      }
    },
    "/api/templates": {
      "post": {
        "operationId": "TemplatesController_create",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateTemplateDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Crea una nueva plantilla de auditoría en estado DRAFT. El nombre y versión deben ser únicos.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/TemplateEntity"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "templates"
        ]
      },
      "get": {
        "operationId": "TemplatesController_findAll",
        "parameters": [
          {
            "name": "page",
            "required": false,
            "in": "query",
            "description": "Número de página (empieza en 1)",
            "schema": {
              "minimum": 1,
              "default": 1,
              "example": 1,
              "type": "number"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "description": "Cantidad de registros por página",
            "schema": {
              "minimum": 1,
              "maximum": 500,
              "default": 10,
              "example": 10,
              "type": "number"
            }
          },
          {
            "name": "all",
            "required": false,
            "in": "query",
            "description": "Si es true, devuelve TODOS los registros (ignora page y limit)",
            "schema": {
              "default": false,
              "example": false,
              "type": "boolean"
            }
          },
          {
            "name": "sortBy",
            "required": false,
            "in": "query",
            "description": "Campo por el cual ordenar los resultados",
            "schema": {
              "example": "createdAt",
              "type": "string"
            }
          },
          {
            "name": "sortOrder",
            "required": false,
            "in": "query",
            "description": "Dirección del ordenamiento (ascendente o descendente)",
            "schema": {
              "default": "DESC",
              "example": "DESC",
              "type": "string",
              "enum": [
                "ASC",
                "DESC"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de recursos obtenida exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/TemplateEntity"
                          }
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "templates"
        ]
      }
    },
    "/api/templates/download-example": {
      "get": {
        "description": "Descarga un archivo Excel de ejemplo que muestra la estructura correcta para importar templates. El archivo incluye:\n- Hoja \"Template\": Metadatos de ejemplo de la plantilla\n- Hoja \"Standards\": Ejemplos de controles con estructura jerárquica correcta (ISO 27001)\n- Hoja \"Instrucciones\": Guía detallada de cómo llenar el archivo\n- Comentarios en celdas para facilitar el uso\n\nLos usuarios pueden usar este archivo como plantilla base, modificar los datos según sus necesidades, y luego importarlo usando el endpoint POST /templates/import",
        "operationId": "TemplatesController_downloadExample",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Archivo Excel de ejemplo generado exitosamente",
            "headers": {
              "Content-Type": {
                "description": "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
              },
              "Content-Disposition": {
                "description": "attachment; filename=template_example_YYYY-MM-DD.xlsx"
              }
            }
          }
        },
        "summary": "Descargar plantilla de ejemplo para importación",
        "tags": [
          "templates"
        ]
      }
    },
    "/api/templates/import": {
      "post": {
        "description": "Importa una plantilla completa con todos sus standards desde un archivo Excel. El archivo debe tener una hoja \"Standards\" con las columnas: código, título, descripción, código padre, orden, nivel, auditable.",
        "operationId": "TemplatesController_import",
        "parameters": [],
        "requestBody": {
          "required": true,
          "description": "Archivo Excel + metadatos de la plantilla",
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "file",
                  "name",
                  "version"
                ],
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "Archivo Excel (.xlsx) con la hoja \"Standards\""
                  },
                  "name": {
                    "type": "string",
                    "description": "Nombre de la plantilla",
                    "example": "ISO 27001"
                  },
                  "version": {
                    "type": "string",
                    "description": "Versión de la plantilla",
                    "example": "1.0"
                  },
                  "description": {
                    "type": "string",
                    "description": "Descripción de la plantilla (opcional)",
                    "example": "Plantilla de controles ISO 27001:2022"
                  },
                  "code": {
                    "type": "string",
                    "description": "Código de la plantilla (opcional)",
                    "example": "ISO27001"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Plantilla importada exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateEntity"
                }
              }
            }
          },
          "400": {
            "description": "Errores de validación en el archivo"
          }
        },
        "summary": "Importar plantilla desde Excel",
        "tags": [
          "templates"
        ]
      }
    },
    "/api/templates/{id}": {
      "get": {
        "operationId": "TemplatesController_findOne",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Recurso encontrado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/TemplateEntity"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "templates"
        ]
      },
      "patch": {
        "operationId": "TemplatesController_update",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateTemplateDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Actualiza una plantilla solo si está en estado DRAFT. Las plantillas publicadas no se pueden editar directamente. Retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "templates"
        ]
      }
    },
    "/api/templates/{id}/publish": {
      "patch": {
        "operationId": "TemplatesController_publish",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Cambia el estado de una plantilla de DRAFT a PUBLISHED. Una vez publicada, la plantilla no se puede editar directamente. Retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "templates"
        ]
      }
    },
    "/api/templates/{id}/archive": {
      "patch": {
        "operationId": "TemplatesController_archive",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Cambia el estado de una plantilla de PUBLISHED a ARCHIVED. Las plantillas archivadas no se usan en nuevas auditorías. Retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "templates"
        ]
      }
    },
    "/api/templates/{id}/export": {
      "get": {
        "description": "Exporta una plantilla completa con todos sus standards a un archivo Excel. El archivo contiene 2 hojas: \"Template\" con metadatos y \"Standards\" con todos los controles ordenados jerárquicamente. Útil para backup, compartir entre entornos o generar datos de prueba.",
        "operationId": "TemplatesController_exportTemplate",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Archivo Excel generado exitosamente",
            "headers": {
              "Content-Type": {
                "description": "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
              },
              "Content-Disposition": {
                "description": "attachment; filename=NombrePlantilla_vVersion_Date.xlsx"
              }
            }
          },
          "404": {
            "description": "Plantilla no encontrada"
          }
        },
        "summary": "Exportar plantilla a Excel",
        "tags": [
          "templates"
        ]
      }
    },
    "/api/standards": {
      "post": {
        "operationId": "StandardsController_create",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateStandardDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Crea un nuevo estándar o control dentro de una plantilla. El código debe ser único dentro de la plantilla.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/StandardResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "standards"
        ]
      },
      "get": {
        "operationId": "StandardsController_getTree",
        "parameters": [
          {
            "name": "search",
            "required": false,
            "in": "query",
            "description": "Búsqueda de texto libre en código, nombre o descripción",
            "schema": {
              "example": "A.5.1.1",
              "type": "string"
            }
          },
          {
            "name": "templateId",
            "required": true,
            "in": "query",
            "description": "ID de la plantilla (UUID)",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "standards"
        ]
      }
    },
    "/api/standards/{id}": {
      "get": {
        "operationId": "StandardsController_findOne",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Recurso encontrado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/StandardResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "standards"
        ]
      },
      "patch": {
        "operationId": "StandardsController_update",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateStandardDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Actualiza los datos de un estándar y retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "standards"
        ]
      },
      "delete": {
        "operationId": "StandardsController_remove",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Elimina permanentemente un estándar. No se puede eliminar si tiene estándares hijos. Retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "standards"
        ]
      }
    },
    "/api/standards/{id}/reorder": {
      "patch": {
        "description": "Cambia el orden de visualización de un estándar entre sus hermanos. Útil para drag & drop en la interfaz.",
        "operationId": "StandardsController_reorder",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReorderStandardDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Estándar reordenado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/StandardResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Solicitud incorrecta",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Estándar no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Cambiar orden de un estándar",
        "tags": [
          "standards"
        ]
      }
    },
    "/api/standards/{id}/activate": {
      "patch": {
        "description": "Marca un estándar como auditable (control evaluable) o no auditable (solo agrupador organizacional).",
        "operationId": "StandardsController_activate",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Estado auditable actualizado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/StandardResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Solicitud incorrecta",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Estándar no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Activar si un estándar es auditable",
        "tags": [
          "standards"
        ]
      }
    },
    "/api/standards/{id}/toggle-auditable": {
      "patch": {
        "description": "Marca un estándar como auditable (control evaluable) o no auditable (solo agrupador organizacional).",
        "operationId": "StandardsController_deactivate",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Estado auditable actualizado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/StandardResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Solicitud incorrecta",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Estándar no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Activar/desactivar si un estándar es auditable",
        "tags": [
          "standards"
        ]
      }
    },
    "/api/maturity/frameworks": {
      "post": {
        "operationId": "MaturityFrameworksController_create",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateMaturityFrameworkDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Crea un nuevo framework de madurez (ej: COBIT 5, CMMI). El código debe ser único.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MaturityFrameworkEntity"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "maturity-frameworks"
        ]
      },
      "get": {
        "description": "Retorna una lista de frameworks con filtros opcionales.",
        "operationId": "MaturityFrameworksController_findAll",
        "parameters": [
          {
            "name": "page",
            "required": false,
            "in": "query",
            "description": "Número de página (empieza en 1)",
            "schema": {
              "minimum": 1,
              "default": 1,
              "example": 1,
              "type": "number"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "description": "Cantidad de registros por página",
            "schema": {
              "minimum": 1,
              "maximum": 500,
              "default": 10,
              "example": 10,
              "type": "number"
            }
          },
          {
            "name": "all",
            "required": false,
            "in": "query",
            "description": "Si es true, devuelve TODOS los registros (ignora page y limit)",
            "schema": {
              "default": false,
              "example": false,
              "type": "boolean"
            }
          },
          {
            "name": "sortBy",
            "required": false,
            "in": "query",
            "description": "Campo por el cual ordenar",
            "schema": {
              "example": "createdAt",
              "type": "string",
              "enum": [
                "name",
                "code",
                "createdAt",
                "isActive",
                "minLevel",
                "maxLevel"
              ]
            }
          },
          {
            "name": "sortOrder",
            "required": false,
            "in": "query",
            "description": "Dirección del ordenamiento (ascendente o descendente)",
            "schema": {
              "default": "DESC",
              "example": "DESC",
              "type": "string",
              "enum": [
                "ASC",
                "DESC"
              ]
            }
          },
          {
            "name": "isActive",
            "required": false,
            "in": "query",
            "description": "Filtrar solo frameworks activos",
            "schema": {
              "example": true,
              "type": "boolean"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de frameworks",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MaturityFrameworkEntity"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Obtener todos los frameworks de madurez",
        "tags": [
          "maturity-frameworks"
        ]
      }
    },
    "/api/maturity/frameworks/{id}": {
      "get": {
        "operationId": "MaturityFrameworksController_findOne",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Retorna los datos completos del framework incluyendo sus niveles de madurez.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MaturityFrameworkEntity"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "maturity-frameworks"
        ]
      },
      "patch": {
        "operationId": "MaturityFrameworksController_update",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateMaturityFrameworkDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Actualiza los datos de un framework y retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "maturity-frameworks"
        ]
      },
      "delete": {
        "operationId": "MaturityFrameworksController_remove",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Elimina permanentemente un framework de madurez sin devolver contenido.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "maturity-frameworks"
        ]
      }
    },
    "/api/maturity/frameworks/{id}/activate": {
      "patch": {
        "operationId": "MaturityFrameworksController_activate",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Cambia el estado isActive a true. Retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "maturity-frameworks"
        ]
      }
    },
    "/api/maturity/frameworks/{id}/deactivate": {
      "patch": {
        "operationId": "MaturityFrameworksController_deactivate",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Cambia el estado isActive a false. Retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "maturity-frameworks"
        ]
      }
    },
    "/api/maturity/levels/{id}": {
      "get": {
        "description": "Retorna los datos de un nivel de madurez específico. Útil para obtener los datos antes de editarlo.",
        "operationId": "MaturityLevelsController_findOne",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Nivel de madurez encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MaturityLevelEntity"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Nivel de madurez no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Obtener un nivel de madurez por ID",
        "tags": [
          "maturity-levels"
        ]
      },
      "patch": {
        "operationId": "MaturityLevelsController_update",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateMaturityLevelDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Actualiza los datos de un nivel de madurez y retorna un mensaje de confirmación.",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MessageResponseDto"
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "tags": [
          "maturity-levels"
        ]
      }
    },
    "/api/maturity/frameworks/{frameworkId}/levels": {
      "get": {
        "description": "Retorna todos los niveles de madurez asociados a un framework específico.",
        "operationId": "MaturityLevelsController_findByFramework",
        "parameters": [
          {
            "name": "frameworkId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Lista de niveles",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/MaturityLevelEntity"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Framework no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/SuccessResponseDto"
                    },
                    {
                      "properties": {
                        "data": {
                          "type": "null",
                          "example": null
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Obtener todos los niveles de un framework",
        "tags": [
          "maturity-levels"
        ]
      }
    },
    "/api/audits": {
      "post": {
        "description": "Crea una nueva auditoría seleccionando template, organización y framework",
        "operationId": "AuditsController_create",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAuditDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Recurso creado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Datos de entrada inválidos",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado - Token inválido o no proporcionado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "403": {
            "description": "Sin permisos - No tiene acceso a este recurso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "409": {
            "description": "El recurso ya existe",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          }
        },
        "summary": "Crear auditoría",
        "tags": [
          "Audits - Auditorías"
        ]
      },
      "get": {
        "description": "Obtiene una lista paginada con capacidades de búsqueda y filtrado.\n\n**Parámetros de paginación:**\n- `page`: Número de página (default: 1)\n- `limit`: Cantidad de resultados por página (default: 10, max: 100)\n- `all`: Devolver todos sin paginación (default: false)\n- `sortBy`: Campo por el cual ordenar (default: createdAt)\n- `sortOrder`: Orden ASC o DESC (default: DESC)\n\n**Parámetros de filtrado:**\n- `search`: Búsqueda de texto libre en code, name, description\n- `status`: Filtrar por estado (enum: DRAFT, IN_PROGRESS, CLOSED, ARCHIVED)\n- `organizationId`: Filtrar por organización (uuid)\n- `templateId`: Filtrar por template (uuid)\n- `revisionType`: Filtrar por tipo: initial | revision (string)\n\n**Campos ordenables:** code, name, status, startDate, endDate, actualStartDate, closedAt, createdAt, updatedAt",
        "operationId": "AuditsController_findAll",
        "parameters": [
          {
            "name": "page",
            "required": false,
            "in": "query",
            "description": "Número de página (empieza en 1)",
            "schema": {
              "minimum": 1,
              "default": 1,
              "example": 1,
              "type": "number"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "description": "Cantidad de registros por página",
            "schema": {
              "minimum": 1,
              "maximum": 500,
              "default": 10,
              "example": 10,
              "type": "number"
            }
          },
          {
            "name": "all",
            "required": false,
            "in": "query",
            "description": "Si es true, devuelve TODOS los registros (ignora page y limit)",
            "schema": {
              "default": false,
              "example": false,
              "type": "boolean"
            }
          },
          {
            "name": "sortBy",
            "required": false,
            "in": "query",
            "description": "Campo por el cual ordenar los resultados",
            "schema": {
              "example": "createdAt",
              "type": "string"
            }
          },
          {
            "name": "sortOrder",
            "required": false,
            "in": "query",
            "description": "Dirección del ordenamiento (ascendente o descendente)",
            "schema": {
              "default": "DESC",
              "example": "DESC",
              "type": "string",
              "enum": [
                "ASC",
                "DESC"
              ]
            }
          },
          {
            "name": "search",
            "required": false,
            "in": "query",
            "description": "Texto de búsqueda (busca en código, nombre y descripción)",
            "schema": {
              "example": "ISO 27001",
              "type": "string"
            }
          },
          {
            "name": "status",
            "required": false,
            "in": "query",
            "description": "Filtrar por estado de la auditoría",
            "schema": {
              "example": "IN_PROGRESS",
              "type": "string",
              "enum": [
                "DRAFT",
                "IN_PROGRESS",
                "CLOSED",
                "ARCHIVED"
              ]
            }
          },
          {
            "name": "organizationId",
            "required": false,
            "in": "query",
            "description": "Filtrar por ID de organización",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          },
          {
            "name": "templateId",
            "required": false,
            "in": "query",
            "description": "Filtrar por ID de template",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440001",
              "type": "string"
            }
          },
          {
            "name": "frameworkId",
            "required": false,
            "in": "query",
            "description": "Filtrar por ID de framework",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440002",
              "type": "string"
            }
          },
          {
            "name": "parentAuditId",
            "required": false,
            "in": "query",
            "description": "Filtrar por ID de auditoría padre (para ver revisiones de una auditoría específica)",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440003",
              "type": "string"
            }
          },
          {
            "name": "revisionType",
            "required": false,
            "in": "query",
            "description": "Filtrar solo auditorías iniciales (sin padre) o solo revisiones (con padre). \"initial\" = solo iniciales, \"revision\" = solo revisiones",
            "schema": {
              "example": "initial",
              "type": "string",
              "enum": [
                "initial",
                "revision"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Respuesta paginada exitosa",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/AuditResponseDto"
                      }
                    },
                    "meta": {
                      "type": "object",
                      "properties": {
                        "total": {
                          "type": "number",
                          "example": 100
                        },
                        "page": {
                          "type": "number",
                          "example": 1
                        },
                        "limit": {
                          "type": "number",
                          "example": 10
                        },
                        "totalPages": {
                          "type": "number",
                          "example": 10
                        },
                        "hasNextPage": {
                          "type": "boolean",
                          "example": true
                        },
                        "hasPrevPage": {
                          "type": "boolean",
                          "example": false
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Datos de entrada inválidos",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado - Token inválido o no proporcionado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "403": {
            "description": "Sin permisos - No tiene acceso a este recurso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          }
        },
        "summary": "Listar auditorías",
        "tags": [
          "Audits - Auditorías"
        ]
      }
    },
    "/api/audits/{id}": {
      "get": {
        "description": "Retorna los datos completos de un audit específico mediante su ID único.",
        "operationId": "AuditsController_findOne",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Recurso encontrado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditResponseDto"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado - Token inválido o no proporcionado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "403": {
            "description": "Sin permisos - No tiene acceso a este recurso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          }
        },
        "summary": "Obtener auditoría por ID",
        "tags": [
          "Audits - Auditorías"
        ]
      },
      "patch": {
        "description": "Solo se pueden actualizar auditorías en estado DRAFT",
        "operationId": "AuditsController_update",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateAuditDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Recurso actualizado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Datos de entrada inválidos",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado - Token inválido o no proporcionado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "403": {
            "description": "Sin permisos - No tiene acceso a este recurso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          }
        },
        "summary": "Actualizar auditoría",
        "tags": [
          "Audits - Auditorías"
        ]
      },
      "delete": {
        "description": "Solo se pueden eliminar auditorías en estado DRAFT",
        "operationId": "AuditsController_remove",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Operación exitosa",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Datos de entrada inválidos",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado - Token inválido o no proporcionado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "403": {
            "description": "Sin permisos - No tiene acceso a este recurso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          }
        },
        "summary": "Eliminar auditoría (soft delete)",
        "tags": [
          "Audits - Auditorías"
        ]
      }
    },
    "/api/audits/{id}/start": {
      "post": {
        "description": "Cambia el estado de DRAFT a IN_PROGRESS. Requiere al menos un miembro asignado.",
        "operationId": "AuditsController_start",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Operación exitosa",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Datos de entrada inválidos",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado - Token inválido o no proporcionado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "403": {
            "description": "Sin permisos - No tiene acceso a este recurso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          }
        },
        "summary": "Iniciar auditoría",
        "tags": [
          "Audits - Auditorías"
        ]
      }
    },
    "/api/audits/{id}/close": {
      "post": {
        "description": "Cambia el estado de IN_PROGRESS a CLOSED. Permite crear auditorías de revisión.",
        "operationId": "AuditsController_close",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Operación exitosa",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Datos de entrada inválidos",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado - Token inválido o no proporcionado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "403": {
            "description": "Sin permisos - No tiene acceso a este recurso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          }
        },
        "summary": "Cerrar auditoría",
        "tags": [
          "Audits - Auditorías"
        ]
      }
    },
    "/api/audits/{id}/revisions": {
      "post": {
        "description": "Crea una auditoría de seguimiento basada en una auditoría CLOSED anterior. Hereda template, organización y framework.",
        "operationId": "AuditsController_createRevision",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateRevisionDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Recurso creado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Datos de entrada inválidos",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado - Token inválido o no proporcionado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "403": {
            "description": "Sin permisos - No tiene acceso a este recurso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "409": {
            "description": "El recurso ya existe",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          }
        },
        "summary": "Crear auditoría de revisión",
        "tags": [
          "Audits - Auditorías"
        ]
      },
      "get": {
        "operationId": "AuditsController_getRevisions",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "summary": "Listar revisiones de una auditoría",
        "tags": [
          "Audits - Auditorías"
        ]
      }
    },
    "/api/audits/{auditId}/assignments": {
      "post": {
        "description": "Asigna un usuario al equipo de auditoría con un rol específico (LEAD_AUDITOR, AUDITOR, AUDITEE, OBSERVER)",
        "operationId": "AuditAssignmentsController_assign",
        "parameters": [
          {
            "name": "auditId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AssignMemberDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Recurso creado exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditAssignmentResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Datos de entrada inválidos",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado - Token inválido o no proporcionado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "403": {
            "description": "Sin permisos - No tiene acceso a este recurso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "409": {
            "description": "El recurso ya existe",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          }
        },
        "summary": "Asignar miembro a auditoría",
        "tags": [
          "Audits - Asignaciones de Miembros"
        ]
      },
      "get": {
        "description": "Obtiene todos los miembros activos asignados a la auditoría",
        "operationId": "AuditAssignmentsController_findAll",
        "parameters": [
          {
            "name": "auditId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Operación exitosa",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditAssignmentResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Datos de entrada inválidos",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado - Token inválido o no proporcionado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "403": {
            "description": "Sin permisos - No tiene acceso a este recurso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          }
        },
        "summary": "Listar miembros de auditoría",
        "tags": [
          "Audits - Asignaciones de Miembros"
        ]
      }
    },
    "/api/audits/{auditId}/assignments/{assignmentId}": {
      "delete": {
        "description": "Desactiva la asignación de un miembro (soft delete)",
        "operationId": "AuditAssignmentsController_remove",
        "parameters": [
          {
            "name": "auditId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "UUID del recurso",
            "schema": {
              "format": "uuid",
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Operación exitosa",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditAssignmentResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Datos de entrada inválidos",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado - Token inválido o no proporcionado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "403": {
            "description": "Sin permisos - No tiene acceso a este recurso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "404": {
            "description": "Recurso no encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponseDto"
                }
              }
            }
          }
        },
        "summary": "Remover miembro de auditoría",
        "tags": [
          "Audits - Asignaciones de Miembros"
        ]
      }
    },
    "/api/navigation/menu": {
      "get": {
        "description": "Retorna la navegación estática (módulos según rol) y dinámica (plantillas disponibles). El menú se personaliza según los roles del usuario autenticado.",
        "operationId": "NavigationController_getMenu",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Menú obtenido exitosamente",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MenuResponseDto"
                }
              }
            }
          },
          "401": {
            "description": "No autenticado"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Obtener menú de navegación completo",
        "tags": [
          "navigation"
        ]
      }
    }
  },
  "info": {
    "title": "ATR API",
    "description": "API de auditorías, plantillas, frameworks de madurez y gestión de usuarios",
    "version": "1.0",
    "contact": {}
  },
  "tags": [
    {
      "name": "Auth",
      "description": "Autenticación JWT con refresh tokens"
    },
    {
      "name": "Two-Factor Authentication",
      "description": "Verificación 2FA"
    },
    {
      "name": "Sessions",
      "description": "Control de Sesiones"
    },
    {
      "name": "Trusted Devices",
      "description": "Trusted Devices"
    },
    {
      "name": "Password Reset",
      "description": "Restablecimiento de Contraseña"
    },
    {
      "name": "users",
      "description": "Gestión de usuarios"
    },
    {
      "name": "organizations",
      "description": "Gestión de organizaciones"
    },
    {
      "name": "templates",
      "description": "Gestión de plantillas (ISO 27001, ISO 9001, etc.)"
    },
    {
      "name": "standards",
      "description": "Gestión de normas con estructura jerárquica"
    },
    {
      "name": "maturity-levels",
      "description": "Niveles de madurez con textos predefinidos"
    }
  ],
  "servers": [],
  "components": {
    "securitySchemes": {
      "bearer": {
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "type": "http"
      }
    },
    "schemas": {
      "AuditLogEntity": {
        "type": "object",
        "properties": {}
      },
      "SuccessResponseDto": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indica si la operación fue exitosa",
            "example": true,
            "default": true
          },
          "statusCode": {
            "type": "number",
            "description": "Código de estado HTTP",
            "example": 200,
            "enum": [
              200,
              201,
              204
            ]
          },
          "message": {
            "type": "string",
            "description": "Mensaje descriptivo de la operación. Se genera automáticamente según el método HTTP o se personaliza con @ResponseMessage",
            "example": "Operación exitosa"
          },
          "data": {
            "type": "object",
            "description": "Datos de la operación. Será null si el endpoint no retorna datos.",
            "nullable": true
          },
          "timestamp": {
            "type": "string",
            "description": "Timestamp ISO 8601 de cuando se generó la respuesta",
            "example": "2024-01-30T10:30:00.000Z"
          }
        },
        "required": [
          "success",
          "statusCode",
          "message",
          "timestamp"
        ]
      },
      "LoginResponseDto": {
        "type": "object",
        "properties": {
          "accessToken": {
            "type": "string",
            "description": "Access token JWT (válido por 15 minutos). Vacío si requiere 2FA. Usar este token para llamar a /auth/me y obtener los datos del usuario.",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
          },
          "require2FA": {
            "type": "boolean",
            "description": "Indica si se requiere verificación de código 2FA. Si es true, el accessToken estará vacío hasta verificar el código. El frontend debe mostrar la pantalla de verificación 2FA.",
            "example": false
          },
          "twoFactorToken": {
            "type": "string",
            "description": "Token temporal para validar el código 2FA. Solo presente cuando require2FA=true. El cliente debe enviarlo en POST /auth/2fa/verify junto con el código recibido por email.",
            "example": "a1b2c3d4e5f6789012345678901234567890123456789012345678901234abcd"
          }
        },
        "required": [
          "accessToken"
        ]
      },
      "LoginDto": {
        "type": "object",
        "properties": {
          "usernameOrEmail": {
            "type": "string",
            "description": "Email o username del usuario",
            "example": "admin@gmail.com",
            "maxLength": 255
          },
          "password": {
            "type": "string",
            "description": "Contraseña del usuario",
            "example": "Password123!",
            "maxLength": 128
          },
          "rememberMe": {
            "type": "boolean",
            "description": "¿Recuérdame? (opcional)",
            "example": true,
            "default": false
          }
        },
        "required": [
          "usernameOrEmail",
          "password"
        ]
      },
      "RefreshResponseDto": {
        "type": "object",
        "properties": {
          "accessToken": {
            "type": "string",
            "description": "Nuevo access token JWT. El refresh token se rota automáticamente y se envía en cookie HTTP-only.",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          }
        },
        "required": [
          "accessToken"
        ]
      },
      "UserResponseDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "ID único del usuario",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "names": {
            "type": "string",
            "description": "Nombres del usuario",
            "example": "Juan Carlos"
          },
          "lastNames": {
            "type": "string",
            "description": "Apellidos del usuario",
            "example": "Pérez García"
          },
          "email": {
            "type": "string",
            "description": "Email del usuario",
            "example": "juan.perez@example.com"
          },
          "username": {
            "type": "string",
            "description": "Nombre de usuario único",
            "example": "juan_perez"
          },
          "ci": {
            "type": "string",
            "description": "Cédula de identidad",
            "example": "1234567-8"
          },
          "phone": {
            "type": "object",
            "description": "Teléfono de contacto",
            "example": "+591 2 234 5678",
            "nullable": true
          },
          "address": {
            "type": "object",
            "description": "Dirección del usuario",
            "example": "Av. 6 de Agosto #123",
            "nullable": true
          },
          "image": {
            "type": "object",
            "description": "URL de la imagen de perfil",
            "example": "https://example.com/images/profile.jpg",
            "nullable": true
          },
          "isActive": {
            "type": "boolean",
            "description": "Estado del usuario",
            "example": true
          },
          "isTemporaryPassword": {
            "type": "boolean",
            "description": "Indica si el usuario debe cambiar su contraseña temporal",
            "example": true
          },
          "firstLoginAt": {
            "type": "object",
            "description": "Fecha y hora del primer login del usuario",
            "example": "2024-01-15T10:30:00.000Z",
            "nullable": true
          },
          "isTwoFactorEnabled": {
            "type": "boolean",
            "description": "Indica si el usuario tiene 2FA habilitado",
            "example": false
          },
          "roles": {
            "type": "array",
            "description": "Roles asignados al usuario",
            "example": [
              "auditor"
            ],
            "items": {
              "type": "string",
              "enum": [
                "admin",
                "gerente",
                "auditor",
                "cliente"
              ]
            }
          },
          "organizationId": {
            "type": "string",
            "description": "ID de la organización a la que pertenece",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "organizationName": {
            "type": "string",
            "description": "Nombre de la organización",
            "example": "Empresa S.A."
          },
          "organizationImage": {
            "type": "object",
            "description": "URL de la imagen de la organización",
            "example": "https://example.com/images/org-logo.jpg",
            "nullable": true
          },
          "createdAt": {
            "format": "date-time",
            "type": "string",
            "description": "Fecha de creación del usuario",
            "example": "2024-01-15T10:30:00.000Z"
          },
          "updatedAt": {
            "format": "date-time",
            "type": "string",
            "description": "Fecha de última actualización",
            "example": "2024-01-15T10:30:00.000Z"
          }
        },
        "required": [
          "id",
          "names",
          "lastNames",
          "email",
          "username",
          "ci",
          "isActive",
          "isTemporaryPassword",
          "isTwoFactorEnabled",
          "roles",
          "organizationId",
          "organizationName",
          "createdAt",
          "updatedAt"
        ]
      },
      "SwitchRoleResponseDto": {
        "type": "object",
        "properties": {
          "accessToken": {
            "type": "string",
            "description": "Nuevo access token con el rol activo cambiado",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          },
          "currentRole": {
            "type": "string",
            "description": "Rol activo actual después del cambio",
            "enum": [
              "admin",
              "gerente",
              "auditor",
              "cliente"
            ],
            "example": "auditor"
          },
          "availableRoles": {
            "type": "array",
            "description": "Lista de todos los roles disponibles del usuario",
            "example": [
              "gerente",
              "auditor"
            ],
            "items": {
              "type": "string",
              "enum": [
                "admin",
                "gerente",
                "auditor",
                "cliente"
              ]
            }
          }
        },
        "required": [
          "accessToken",
          "currentRole",
          "availableRoles"
        ]
      },
      "SwitchRoleDto": {
        "type": "object",
        "properties": {
          "newRole": {
            "type": "string",
            "description": "Nuevo rol activo que el usuario quiere usar",
            "enum": [
              "admin",
              "gerente",
              "auditor",
              "cliente"
            ],
            "example": "auditor"
          }
        },
        "required": [
          "newRole"
        ]
      },
      "RequestResetResponseDto": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "description": "Mensaje genérico (respuesta segura anti-enumeración)",
            "example": "Si el email existe, recibirás un código de verificación en tu correo"
          },
          "tokenId": {
            "type": "string",
            "description": "Token ID para el reset (64 caracteres). El código OTP se envía por email.",
            "example": "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2"
          }
        },
        "required": [
          "message"
        ]
      },
      "RequestResetPasswordDto": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "description": "Email del usuario que solicita el reset",
            "example": "usuario@example.com"
          }
        },
        "required": [
          "email"
        ]
      },
      "MessageResponseDto": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "description": "Mensaje descriptivo de la operación",
            "example": "Operación completada exitosamente"
          }
        },
        "required": [
          "message"
        ]
      },
      "ResetPasswordDto": {
        "type": "object",
        "properties": {
          "tokenId": {
            "type": "string",
            "description": "Token ID de reset password (64 caracteres hexadecimales)",
            "example": "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2",
            "minLength": 64,
            "maxLength": 64
          },
          "otpCode": {
            "type": "string",
            "description": "Código OTP de 6 dígitos (recibido por correo)",
            "example": "123456",
            "minLength": 6,
            "maxLength": 6
          },
          "newPassword": {
            "type": "string",
            "description": "Nueva contraseña (debe cumplir requisitos de complejidad)",
            "example": "NewSecurePass123!",
            "minLength": 8,
            "maxLength": 128
          }
        },
        "required": [
          "tokenId",
          "otpCode",
          "newPassword"
        ]
      },
      "Verify2FAResponseDto": {
        "type": "object",
        "properties": {
          "valid": {
            "type": "boolean",
            "description": "Indica si el código 2FA fue válido",
            "example": true
          },
          "message": {
            "type": "string",
            "description": "Mensaje descriptivo del resultado",
            "example": "Código verificado exitosamente. Sesión iniciada."
          },
          "accessToken": {
            "type": "string",
            "description": "Access token JWT para autenticación. El refresh token se envía en cookie HTTP-only.",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          }
        },
        "required": [
          "valid",
          "message",
          "accessToken"
        ]
      },
      "Verify2FACodeDto": {
        "type": "object",
        "properties": {
          "token": {
            "type": "string",
            "description": "TokenId de 64 caracteres hexadecimales (NO es JWT, es el identificador de sesión 2FA). Este tokenId se recibe al hacer login cuando 2FA está habilitado. Contiene el userId en el payload almacenado en Redis.",
            "example": "a1b2c3d4e5f6789012345678901234567890123456789012345678901234abcd",
            "minLength": 64,
            "maxLength": 64
          },
          "code": {
            "type": "string",
            "description": "Código numérico de 6 dígitos",
            "example": "123456",
            "minLength": 6,
            "maxLength": 6
          },
          "trustDevice": {
            "type": "boolean",
            "description": "¿Confiar en este dispositivo? Si es true, el usuario no necesitará 2FA en este dispositivo por 90 días. El backend generará automáticamente el fingerprint del dispositivo usando User-Agent e IP.",
            "example": true,
            "default": false
          }
        },
        "required": [
          "token",
          "code"
        ]
      },
      "Resend2FACodeDto": {
        "type": "object",
        "properties": {
          "token": {
            "type": "string",
            "description": "TokenId de 64 caracteres hexadecimales (NO es JWT, es el identificador de sesión 2FA)",
            "example": "a1b2c3d4e5f6789012345678901234567890123456789012345678901234abcd",
            "minLength": 64,
            "maxLength": 64
          }
        },
        "required": [
          "token"
        ]
      },
      "SessionResponseDto": {
        "type": "object",
        "properties": {
          "sessionId": {
            "type": "string",
            "description": "ID de la sesión (tokenId)",
            "example": "a1b2c3d4-e5f6-4321-a1b2-c3d4e5f6a7b8"
          },
          "ip": {
            "type": "string",
            "description": "Dirección IP desde donde se inició la sesión",
            "example": "192.168.1.100"
          },
          "browser": {
            "type": "string",
            "description": "Navegador usado",
            "example": "Chrome 120"
          },
          "os": {
            "type": "string",
            "description": "Sistema operativo",
            "example": "Windows 11"
          },
          "device": {
            "type": "string",
            "description": "Dispositivo",
            "example": "Desktop"
          },
          "createdAt": {
            "type": "number",
            "description": "Fecha de creación de la sesión (timestamp Unix en ms)",
            "example": 1705497600000
          },
          "lastActiveAt": {
            "type": "number",
            "description": "Última actividad en la sesión (timestamp Unix en ms)",
            "example": 1705497600000
          },
          "isCurrent": {
            "type": "boolean",
            "description": "Indica si esta es la sesión actual del usuario",
            "example": true
          }
        },
        "required": [
          "sessionId",
          "ip",
          "createdAt",
          "lastActiveAt",
          "isCurrent"
        ]
      },
      "RevokeSessionDto": {
        "type": "object",
        "properties": {
          "sessionId": {
            "type": "string",
            "description": "ID de la sesión a revocar (tokenId)",
            "example": "a1b2c3d4-e5f6-4321-a1b2-c3d4e5f6a7b8"
          }
        },
        "required": [
          "sessionId"
        ]
      },
      "MessageWithCountResponseDto": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "description": "Mensaje descriptivo de la operación",
            "example": "Todas las sesiones han sido cerradas"
          },
          "count": {
            "type": "number",
            "description": "Cantidad de registros afectados",
            "example": 5
          }
        },
        "required": [
          "message",
          "count"
        ]
      },
      "TrustedDeviceResponseDto": {
        "type": "object",
        "properties": {
          "fingerprint": {
            "type": "string",
            "description": "Fingerprint del dispositivo (identificador único)",
            "example": "abc123def456ghi789jkl012mno345pqr678stu901vwx234yz"
          },
          "browser": {
            "type": "string",
            "description": "Navegador usado",
            "example": "Chrome 120"
          },
          "os": {
            "type": "string",
            "description": "Sistema operativo",
            "example": "Windows 11"
          },
          "device": {
            "type": "string",
            "description": "Dispositivo",
            "example": "Desktop"
          },
          "ip": {
            "type": "string",
            "description": "Dirección IP desde donde se agregó",
            "example": "192.168.1.100"
          },
          "createdAt": {
            "type": "number",
            "description": "Fecha de creación (timestamp Unix en ms)",
            "example": 1705497600000
          },
          "lastUsedAt": {
            "type": "number",
            "description": "Última fecha de uso (timestamp Unix en ms)",
            "example": 1705497600000
          }
        },
        "required": [
          "fingerprint",
          "browser",
          "os",
          "device",
          "ip",
          "createdAt",
          "lastUsedAt"
        ]
      },
      "RevokeDeviceDto": {
        "type": "object",
        "properties": {
          "fingerprint": {
            "type": "string",
            "description": "Fingerprint del dispositivo a revocar",
            "example": "abc123def456ghi789jkl012mno345pqr678stu901vwx234yz"
          }
        },
        "required": [
          "fingerprint"
        ]
      },
      "ChangeUserEmailDto": {
        "type": "object",
        "properties": {
          "newEmail": {
            "type": "string",
            "description": "Nuevo email del usuario",
            "example": "nuevo.email@example.com",
            "maxLength": 100
          }
        },
        "required": [
          "newEmail"
        ]
      },
      "ChangePasswordDto": {
        "type": "object",
        "properties": {
          "currentPassword": {
            "type": "string",
            "description": "Contraseña actual del usuario",
            "example": "OldPassword123!",
            "minLength": 8,
            "maxLength": 100
          },
          "newPassword": {
            "type": "string",
            "description": "Nueva contraseña",
            "example": "NewPassword123!",
            "minLength": 8,
            "maxLength": 100
          }
        },
        "required": [
          "currentPassword",
          "newPassword"
        ]
      },
      "CreateUserDto": {
        "type": "object",
        "properties": {
          "names": {
            "type": "string",
            "description": "Nombres del usuario",
            "example": "Juan Carlos",
            "minLength": 2,
            "maxLength": 50
          },
          "lastNames": {
            "type": "string",
            "description": "Apellidos del usuario",
            "example": "Pérez García",
            "minLength": 2,
            "maxLength": 50
          },
          "email": {
            "type": "string",
            "description": "Email del usuario",
            "example": "juan.perez@example.com",
            "maxLength": 100
          },
          "username": {
            "type": "string",
            "description": "Nombre de usuario (solo letras, números y guión bajo)",
            "example": "juan_perez",
            "minLength": 3,
            "maxLength": 30
          },
          "ci": {
            "type": "string",
            "description": "Cédula de Identidad",
            "example": "1234567-8",
            "minLength": 5,
            "maxLength": 15
          },
          "phone": {
            "type": "string",
            "description": "Teléfono de contacto",
            "example": "+591 2 234 5678",
            "maxLength": 20
          },
          "address": {
            "type": "string",
            "description": "Dirección del usuario",
            "example": "Av. 6 de Agosto #123, La Paz",
            "maxLength": 200
          },
          "organizationId": {
            "type": "string",
            "description": "ID de la organización a la que pertenece el usuario (requerido)",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "roles": {
            "type": "array",
            "description": "Roles del usuario",
            "example": [
              "auditor"
            ],
            "items": {
              "type": "string",
              "enum": [
                "admin",
                "gerente",
                "auditor",
                "cliente"
              ]
            }
          }
        },
        "required": [
          "names",
          "lastNames",
          "email",
          "username",
          "ci",
          "organizationId",
          "roles"
        ]
      },
      "UpdateUserDto": {
        "type": "object",
        "properties": {
          "names": {
            "type": "string",
            "description": "Nombres del usuario",
            "example": "Juan Carlos",
            "minLength": 2,
            "maxLength": 50
          },
          "lastNames": {
            "type": "string",
            "description": "Apellidos del usuario",
            "example": "Pérez García",
            "minLength": 2,
            "maxLength": 50
          },
          "username": {
            "type": "string",
            "description": "Nombre de usuario (solo letras, números y guión bajo)",
            "example": "juan_perez",
            "minLength": 3,
            "maxLength": 30
          },
          "ci": {
            "type": "string",
            "description": "Cédula de Identidad",
            "example": "1234567-8",
            "minLength": 5,
            "maxLength": 15
          },
          "phone": {
            "type": "string",
            "description": "Teléfono de contacto",
            "example": "+591 2 234 5678",
            "maxLength": 20
          },
          "address": {
            "type": "string",
            "description": "Dirección del usuario",
            "example": "Av. 6 de Agosto #123, La Paz",
            "maxLength": 200
          },
          "roles": {
            "type": "array",
            "description": "Roles del usuario",
            "example": [
              "auditor"
            ],
            "items": {
              "type": "string",
              "enum": [
                "admin",
                "gerente",
                "auditor",
                "cliente"
              ]
            }
          }
        }
      },
      "OrganizationResponseDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "example": "123e4567-e89b-12d3-a456-426614174000",
            "description": "ID único de la organización"
          },
          "name": {
            "type": "string",
            "example": "Coca Cola Bolivia",
            "description": "Nombre de la organización"
          },
          "nit": {
            "type": "string",
            "example": "1234567890",
            "description": "NIT de la organización"
          },
          "description": {
            "type": "object",
            "example": "Empresa líder en la industria de bebidas",
            "description": "Descripción de la organización",
            "nullable": true
          },
          "address": {
            "type": "object",
            "example": "Av. Siempre Viva 123, La Paz",
            "description": "Dirección física de la organización",
            "nullable": true
          },
          "phone": {
            "type": "object",
            "example": "+591 2 1234567",
            "description": "Teléfono de contacto",
            "nullable": true
          },
          "email": {
            "type": "object",
            "example": "info@cocacola.bo",
            "description": "Correo electrónico de contacto",
            "nullable": true
          },
          "logoUrl": {
            "type": "object",
            "example": "/uploads/organizations/logos/org-123.png",
            "description": "URL del logo de la organización",
            "nullable": true
          },
          "isActive": {
            "type": "boolean",
            "example": true,
            "description": "Indica si la organización está activa"
          },
          "createdAt": {
            "type": "string",
            "example": "2024-01-15T10:30:00Z",
            "description": "Fecha de creación"
          },
          "updatedAt": {
            "type": "string",
            "example": "2024-06-20T14:45:00Z",
            "description": "Fecha de última actualización"
          }
        },
        "required": [
          "id",
          "name",
          "nit",
          "isActive",
          "createdAt",
          "updatedAt"
        ]
      },
      "CreateOrganizationDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Nombre de la organización",
            "example": "Acme Corporation",
            "minLength": 3,
            "maxLength": 200
          },
          "nit": {
            "type": "string",
            "description": "Número de Identificación Tributaria (NIT)",
            "example": "900123456-7",
            "minLength": 5,
            "maxLength": 50
          },
          "description": {
            "type": "string",
            "description": "Descripción de la organización",
            "example": "Empresa líder en tecnología",
            "maxLength": 2000
          },
          "address": {
            "type": "string",
            "description": "Dirección física de la organización",
            "example": "Calle 123 #45-67, Bogotá",
            "maxLength": 500
          },
          "phone": {
            "type": "string",
            "description": "Teléfono de contacto",
            "example": "+57 1 234 5678",
            "maxLength": 50
          },
          "email": {
            "type": "string",
            "description": "Email de contacto",
            "example": "contacto@acme.com",
            "maxLength": 200
          }
        },
        "required": [
          "name",
          "nit"
        ]
      },
      "UpdateOrganizationDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Nombre de la organización",
            "example": "Acme Corporation",
            "minLength": 3,
            "maxLength": 200
          },
          "nit": {
            "type": "string",
            "description": "Número de Identificación Tributaria (NIT)",
            "example": "900123456-7",
            "minLength": 5,
            "maxLength": 50
          },
          "description": {
            "type": "string",
            "description": "Descripción de la organización",
            "example": "Empresa líder en tecnología",
            "maxLength": 2000
          },
          "address": {
            "type": "string",
            "description": "Dirección física de la organización",
            "example": "Calle 123 #45-67, Bogotá",
            "maxLength": 500
          },
          "phone": {
            "type": "string",
            "description": "Teléfono de contacto",
            "example": "+57 1 234 5678",
            "maxLength": 50
          },
          "email": {
            "type": "string",
            "description": "Email de contacto",
            "example": "contacto@acme.com",
            "maxLength": 200
          }
        }
      },
      "TemplateEntity": {
        "type": "object",
        "properties": {}
      },
      "CreateTemplateDto": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "description": "Código único agrupador de la familia de la norma",
            "example": "ISO-27001",
            "minLength": 3,
            "maxLength": 50
          },
          "name": {
            "type": "string",
            "description": "Nombre completo y descriptivo de la plantilla",
            "example": "Norma ISO/IEC 27001:2022 Seguridad de la Información",
            "minLength": 5,
            "maxLength": 150
          },
          "description": {
            "type": "string",
            "description": "Descripción detallada, alcance o notas sobre esta versión",
            "example": "Versión actualizada con los nuevos controles del Anexo A.",
            "maxLength": 2000
          },
          "version": {
            "type": "string",
            "description": "Identificador de la versión (Año, Revisión o SemVer)",
            "example": "2022",
            "minLength": 1,
            "maxLength": 20
          }
        },
        "required": [
          "code",
          "name",
          "version"
        ]
      },
      "UpdateTemplateDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Nombre completo y descriptivo de la plantilla",
            "example": "Norma ISO/IEC 27001:2022 Seguridad de la Información",
            "minLength": 5,
            "maxLength": 150
          },
          "description": {
            "type": "string",
            "description": "Descripción detallada, alcance o notas sobre esta versión",
            "example": "Versión actualizada con los nuevos controles del Anexo A.",
            "maxLength": 2000
          }
        }
      },
      "StandardResponseDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "example": "123e4567-e89b-12d3-a456-426614174000",
            "description": "ID único del estándar"
          },
          "templateId": {
            "type": "string",
            "example": "123e4567-e89b-12d3-a456-426614174000",
            "description": "ID de la plantilla a la que pertenece"
          },
          "parentId": {
            "type": "object",
            "example": "123e4567-e89b-12d3-a456-426614174000",
            "description": "ID del estándar padre (null para nivel raíz)",
            "nullable": true
          },
          "code": {
            "type": "string",
            "example": "A.5.1.1",
            "description": "Código único del estándar dentro de la plantilla"
          },
          "title": {
            "type": "string",
            "example": "Políticas para la seguridad de la información",
            "description": "Título del estándar"
          },
          "description": {
            "type": "object",
            "example": "Descripción detallada del estándar...",
            "description": "Descripción detallada del estándar",
            "nullable": true
          },
          "order": {
            "type": "number",
            "example": 1,
            "description": "Orden de visualización dentro de su nivel"
          },
          "level": {
            "type": "number",
            "example": 3,
            "description": "Nivel en la jerarquía (1 = raíz)"
          },
          "isAuditable": {
            "type": "boolean",
            "example": true,
            "description": "Indica si este estándar es auditable"
          },
          "weight": {
            "type": "number",
            "example": 15.5,
            "description": "Peso/ponderación del estándar (0-100). Solo aplica si isAuditable = true"
          },
          "auditorGuidance": {
            "type": "object",
            "example": "Verificar existencia de política documentada y firmada por gerencia. Revisar fecha de última actualización.",
            "description": "Guía/recomendaciones para el auditor sobre qué verificar",
            "nullable": true
          },
          "createdAt": {
            "format": "date-time",
            "type": "string",
            "example": "2024-01-20T10:30:00Z",
            "description": "Fecha de creación"
          },
          "updatedAt": {
            "format": "date-time",
            "type": "string",
            "example": "2024-06-15T14:45:00Z",
            "description": "Fecha de última actualización"
          },
          "createdBy": {
            "type": "string",
            "example": "user-id-123",
            "description": "ID del usuario que creó el estándar",
            "nullable": true
          },
          "updatedBy": {
            "type": "string",
            "example": "user-id-456",
            "description": "ID del usuario que actualizó el estándar",
            "nullable": true
          }
        },
        "required": [
          "id",
          "templateId",
          "parentId",
          "code",
          "title",
          "description",
          "order",
          "level",
          "isAuditable",
          "weight",
          "auditorGuidance",
          "createdAt",
          "updatedAt",
          "createdBy",
          "updatedBy"
        ]
      },
      "CreateStandardDto": {
        "type": "object",
        "properties": {
          "templateId": {
            "type": "string",
            "description": "ID del template al que pertenece",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "parentId": {
            "type": "string",
            "description": "ID del standard padre (null para nivel raíz)",
            "example": "550e8400-e29b-41d4-a716-446655440001"
          },
          "code": {
            "type": "string",
            "description": "Código único del standard",
            "example": "A.5.1.1",
            "minLength": 1,
            "maxLength": 50
          },
          "title": {
            "type": "string",
            "description": "Título del standard",
            "example": "Políticas para la seguridad de la información",
            "minLength": 2,
            "maxLength": 200
          },
          "description": {
            "type": "string",
            "description": "Descripción detallada",
            "maxLength": 2000
          },
          "weight": {
            "type": "number",
            "description": "Peso/ponderación del estándar (0-100). Solo aplica si isAuditable = true. Se puede configurar después.",
            "example": 15.5,
            "minimum": 0,
            "maximum": 100
          },
          "auditorGuidance": {
            "type": "string",
            "description": "Guía/recomendaciones para el auditor. Describe qué debe verificar o evaluar. Puede estar en cualquier nivel.",
            "example": "Verificar existencia de política documentada y firmada por gerencia. Revisar fecha de última actualización (debe ser < 1 año)."
          }
        },
        "required": [
          "templateId",
          "code",
          "title"
        ]
      },
      "UpdateStandardDto": {
        "type": "object",
        "properties": {
          "title": {
            "type": "string",
            "description": "Título del standard",
            "example": "Políticas para la seguridad de la información",
            "minLength": 2,
            "maxLength": 200
          },
          "description": {
            "type": "string",
            "description": "Descripción detallada",
            "maxLength": 2000
          },
          "weight": {
            "type": "number",
            "description": "Peso/ponderación del estándar (0-100). Solo aplica si isAuditable = true. Se puede configurar después.",
            "example": 15.5,
            "minimum": 0,
            "maximum": 100
          },
          "auditorGuidance": {
            "type": "string",
            "description": "Guía/recomendaciones para el auditor. Describe qué debe verificar o evaluar. Puede estar en cualquier nivel.",
            "example": "Verificar existencia de política documentada y firmada por gerencia. Revisar fecha de última actualización (debe ser < 1 año)."
          }
        }
      },
      "ReorderStandardDto": {
        "type": "object",
        "properties": {
          "newOrder": {
            "type": "number",
            "description": "Nuevo orden de visualización (posición entre hermanos)",
            "example": 3,
            "minimum": 0
          }
        },
        "required": [
          "newOrder"
        ]
      },
      "MaturityFrameworkEntity": {
        "type": "object",
        "properties": {}
      },
      "CreateNestedMaturityLevelDto": {
        "type": "object",
        "properties": {
          "level": {
            "type": "number",
            "description": "Número del nivel de madurez",
            "example": 3,
            "minimum": 0
          },
          "name": {
            "type": "string",
            "description": "Nombre completo del nivel",
            "example": "Definido",
            "minLength": 2,
            "maxLength": 100
          },
          "shortName": {
            "type": "string",
            "description": "Nombre corto/abreviado del nivel",
            "example": "Def",
            "maxLength": 20
          },
          "description": {
            "type": "string",
            "description": "Descripción completa del nivel",
            "example": "Los procesos están documentados, estandarizados e integrados en toda la organización."
          },
          "color": {
            "type": "string",
            "description": "Color en formato hexadecimal",
            "example": "#F59E0B",
            "pattern": "^#[0-9A-Fa-f]{6}$"
          },
          "recommendations": {
            "type": "string",
            "description": "Recomendaciones para alcanzar este nivel",
            "example": "Implementar métricas de rendimiento y monitoreo continuo."
          },
          "observations": {
            "type": "string",
            "description": "Observaciones típicas en este nivel",
            "example": "Procesos documentados y comunicados mediante capacitación."
          },
          "order": {
            "type": "number",
            "description": "Orden de visualización (si no se especifica, usa el número de nivel)",
            "example": 3,
            "minimum": 0
          },
          "isMinimumAcceptable": {
            "type": "boolean",
            "description": "🎯 Nivel mínimo sugerido por defecto (defaultMinimum). Útil para pre-llenar configuración de auditoría.",
            "example": false,
            "default": false
          },
          "isTarget": {
            "type": "boolean",
            "description": "🎯 Nivel objetivo sugerido por defecto (industryStandard). Útil para pre-llenar configuración de auditoría.",
            "example": false,
            "default": false
          }
        },
        "required": [
          "level",
          "name",
          "description",
          "color"
        ]
      },
      "CreateMaturityFrameworkDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Nombre del framework",
            "example": "COBIT 5",
            "minLength": 2,
            "maxLength": 100
          },
          "code": {
            "type": "string",
            "description": "Código único identificador (solo letras minúsculas, números y guiones)",
            "example": "cobit5",
            "minLength": 2,
            "maxLength": 50
          },
          "description": {
            "type": "string",
            "description": "Descripción del framework",
            "example": "Framework de gobierno y gestión de TI empresarial"
          },
          "minLevel": {
            "type": "number",
            "description": "Nivel mínimo del framework",
            "example": 0,
            "default": 0,
            "minimum": 0,
            "maximum": 10
          },
          "maxLevel": {
            "type": "number",
            "description": "Nivel máximo del framework",
            "example": 5,
            "default": 5,
            "minimum": 1,
            "maximum": 10
          },
          "levels": {
            "description": "Niveles de madurez del framework (OBLIGATORIO - creación atómica). Los niveles se crean junto con el framework y no se pueden crear por separado. Solo se permite editar los niveles existentes después de crear el framework. IMPORTANTE: La cantidad de niveles debe coincidir con (maxLevel - minLevel + 1) y deben cubrir todos los valores desde minLevel hasta maxLevel sin saltos.",
            "example": [
              {
                "level": 0,
                "name": "Inexistente",
                "shortName": "N/A",
                "description": "No existe proceso documentado",
                "color": "#EF4444",
                "order": 0
              },
              {
                "level": 1,
                "name": "Inicial",
                "shortName": "Init",
                "description": "Procesos ad-hoc y desorganizados",
                "color": "#F59E0B",
                "icon": "🟠",
                "order": 1,
                "isMinimumAcceptable": true
              },
              {
                "level": 2,
                "name": "Repetible",
                "shortName": "Rep",
                "description": "Procesos repetibles con resultados consistentes",
                "color": "#FBBF24",
                "icon": "🟡",
                "order": 2
              },
              {
                "level": 3,
                "name": "Definido",
                "shortName": "Def",
                "description": "Procesos documentados y estandarizados",
                "color": "#3B82F6",
                "icon": "🔵",
                "order": 3
              },
              {
                "level": 4,
                "name": "Administrado",
                "shortName": "Adm",
                "description": "Procesos medidos y controlados",
                "color": "#8B5CF6",
                "icon": "🟣",
                "order": 4
              },
              {
                "level": 5,
                "name": "Optimizado",
                "shortName": "Opt",
                "description": "Mejora continua basada en métricas",
                "color": "#10B981",
                "icon": "🟢",
                "order": 5,
                "isTarget": true
              }
            ],
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreateNestedMaturityLevelDto"
            }
          }
        },
        "required": [
          "name",
          "code",
          "levels"
        ]
      },
      "UpdateMaturityFrameworkDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Nombre del framework",
            "example": "COBIT 5",
            "minLength": 2,
            "maxLength": 100
          },
          "code": {
            "type": "string",
            "description": "Código único identificador (solo letras minúsculas, números y guiones)",
            "example": "cobit5",
            "minLength": 2,
            "maxLength": 50
          },
          "description": {
            "type": "string",
            "description": "Descripción del framework",
            "example": "Framework de gobierno y gestión de TI empresarial"
          }
        }
      },
      "MaturityLevelEntity": {
        "type": "object",
        "properties": {}
      },
      "UpdateMaturityLevelDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Nombre completo del nivel",
            "example": "Definido",
            "minLength": 2,
            "maxLength": 100
          },
          "shortName": {
            "type": "string",
            "description": "Nombre corto/abreviado del nivel",
            "example": "Def",
            "maxLength": 20
          },
          "description": {
            "type": "string",
            "description": "Descripción completa del nivel",
            "example": "Los procesos están documentados, estandarizados e integrados en toda la organización."
          },
          "color": {
            "type": "string",
            "description": "Color en formato hexadecimal",
            "example": "#F59E0B",
            "pattern": "^#[0-9A-Fa-f]{6}$"
          },
          "recommendations": {
            "type": "string",
            "description": "Recomendaciones para alcanzar este nivel",
            "example": "Implementar métricas de rendimiento y monitoreo continuo."
          },
          "observations": {
            "type": "string",
            "description": "Observaciones típicas en este nivel",
            "example": "Procesos documentados y comunicados mediante capacitación."
          },
          "order": {
            "type": "number",
            "description": "Orden de visualización (si no se especifica, usa el número de nivel)",
            "example": 3,
            "minimum": 0
          },
          "isMinimumAcceptable": {
            "type": "boolean",
            "description": "🎯 Nivel mínimo sugerido por defecto (defaultMinimum). Útil para pre-llenar configuración de auditoría.",
            "example": false,
            "default": false
          },
          "isTarget": {
            "type": "boolean",
            "description": "🎯 Nivel objetivo sugerido por defecto (industryStandard). Útil para pre-llenar configuración de auditoría.",
            "example": false,
            "default": false
          }
        }
      },
      "AuditResponseDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "code": {
            "type": "string",
            "example": "AUD-2024-001"
          },
          "name": {
            "type": "string",
            "example": "Auditoría ISO 27001 - Empresa XYZ Q1 2024"
          },
          "description": {
            "type": "object",
            "example": "Evaluación anual de seguridad de información",
            "nullable": true
          },
          "templateId": {
            "type": "string",
            "example": "550e8400-e29b-41d4-a716-446655440001"
          },
          "organizationId": {
            "type": "string",
            "example": "550e8400-e29b-41d4-a716-446655440002"
          },
          "frameworkId": {
            "type": "object",
            "example": "550e8400-e29b-41d4-a716-446655440003",
            "nullable": true
          },
          "parentAuditId": {
            "type": "object",
            "example": "550e8400-e29b-41d4-a716-446655440004",
            "nullable": true
          },
          "revisionNumber": {
            "type": "number",
            "example": 0
          },
          "status": {
            "type": "string",
            "enum": [
              "DRAFT",
              "IN_PROGRESS",
              "CLOSED",
              "ARCHIVED"
            ],
            "example": "DRAFT"
          },
          "startDate": {
            "type": "object",
            "example": "2024-02-01T00:00:00.000Z",
            "nullable": true
          },
          "endDate": {
            "type": "object",
            "example": "2024-02-28T23:59:59.999Z",
            "nullable": true
          },
          "actualStartDate": {
            "type": "object",
            "example": "2024-02-01T09:00:00.000Z",
            "nullable": true
          },
          "closedAt": {
            "type": "object",
            "example": "2024-02-28T18:00:00.000Z",
            "nullable": true
          },
          "overallScore": {
            "type": "object",
            "example": null,
            "nullable": true
          },
          "maturityLevel": {
            "type": "object",
            "example": null,
            "nullable": true
          },
          "createdAt": {
            "format": "date-time",
            "type": "string",
            "example": "2024-01-15T10:30:00.000Z"
          },
          "updatedAt": {
            "format": "date-time",
            "type": "string",
            "example": "2024-01-15T10:30:00.000Z"
          },
          "createdBy": {
            "type": "object",
            "example": "550e8400-e29b-41d4-a716-446655440005",
            "nullable": true
          },
          "updatedBy": {
            "type": "object",
            "example": "550e8400-e29b-41d4-a716-446655440005",
            "nullable": true
          }
        },
        "required": [
          "id",
          "code",
          "name",
          "description",
          "templateId",
          "organizationId",
          "frameworkId",
          "parentAuditId",
          "revisionNumber",
          "status",
          "startDate",
          "endDate",
          "actualStartDate",
          "closedAt",
          "overallScore",
          "maturityLevel",
          "createdAt",
          "updatedAt",
          "createdBy",
          "updatedBy"
        ]
      },
      "ErrorResponseDto": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indica si la operación fue exitosa (siempre false para errores)",
            "example": false,
            "default": false
          },
          "statusCode": {
            "type": "number",
            "description": "Código de estado HTTP del error",
            "example": 400,
            "enum": [
              400,
              401,
              403,
              404,
              409,
              422,
              500
            ]
          },
          "message": {
            "description": "Mensaje de error. Puede ser un string simple o array de strings para errores de validación",
            "oneOf": [
              {
                "type": "string",
                "example": "Usuario no encontrado"
              },
              {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "example": [
                  "email debe ser un email válido",
                  "password es requerido"
                ]
              }
            ]
          },
          "error": {
            "type": "string",
            "description": "Nombre del error HTTP",
            "example": "Bad Request",
            "enum": [
              "Bad Request",
              "Unauthorized",
              "Forbidden",
              "Not Found",
              "Conflict",
              "Unprocessable Entity",
              "Internal Server Error"
            ]
          },
          "errors": {
            "type": "array",
            "description": "Array de errores adicionales (usado en errores de importación masiva, etc.)",
            "items": {
              "type": "object"
            }
          },
          "validationErrors": {
            "type": "object",
            "description": "Errores de validación agrupados por campo (generado por class-validator)",
            "example": {
              "email": [
                "debe ser un email válido"
              ],
              "password": [
                "es requerido",
                "debe tener al menos 8 caracteres"
              ]
            }
          },
          "summary": {
            "type": "object",
            "description": "Resumen de errores (usado en operaciones batch)"
          },
          "totalErrors": {
            "type": "number",
            "description": "Número total de errores encontrados",
            "example": 5
          },
          "details": {
            "type": "object",
            "description": "Detalles adicionales del error (solo en desarrollo)"
          },
          "timestamp": {
            "type": "string",
            "description": "Timestamp ISO 8601 de cuando ocurrió el error",
            "example": "2024-01-30T10:30:00.000Z"
          },
          "path": {
            "type": "string",
            "description": "Ruta del endpoint que generó el error",
            "example": "/api/users/123"
          },
          "method": {
            "type": "string",
            "description": "Método HTTP que generó el error",
            "example": "POST",
            "enum": [
              "GET",
              "POST",
              "PUT",
              "PATCH",
              "DELETE"
            ]
          }
        },
        "required": [
          "success",
          "statusCode",
          "message",
          "error",
          "timestamp"
        ]
      },
      "CreateAuditDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Nombre descriptivo de la auditoría",
            "example": "Auditoría ISO 27001 - Empresa XYZ Q1 2024",
            "minLength": 3,
            "maxLength": 255
          },
          "description": {
            "type": "string",
            "description": "Descripción detallada de la auditoría (opcional)",
            "example": "Evaluación anual de cumplimiento de seguridad de la información según ISO 27001"
          },
          "templateId": {
            "type": "string",
            "description": "ID del template base (plantilla de auditoría). Debe estar en estado PUBLISHED.",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "organizationId": {
            "type": "string",
            "description": "ID de la organización a auditar",
            "example": "550e8400-e29b-41d4-a716-446655440001"
          },
          "frameworkId": {
            "type": "string",
            "description": "ID del framework de madurez a utilizar (opcional). Ej: COBIT 5, CMMI",
            "example": "550e8400-e29b-41d4-a716-446655440002"
          },
          "startDate": {
            "type": "string",
            "description": "Fecha de inicio planificada (opcional)",
            "example": "2024-02-01"
          },
          "endDate": {
            "type": "string",
            "description": "Fecha de fin planificada (opcional)",
            "example": "2024-02-28"
          }
        },
        "required": [
          "name",
          "templateId",
          "organizationId"
        ]
      },
      "UpdateAuditDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Nombre descriptivo de la auditoría",
            "example": "Auditoría ISO 27001 - Empresa XYZ Q1 2024 (Actualizado)",
            "minLength": 3,
            "maxLength": 255
          },
          "description": {
            "type": "string",
            "description": "Descripción detallada de la auditoría",
            "example": "Evaluación actualizada con nuevo alcance"
          },
          "frameworkId": {
            "type": "string",
            "description": "ID del framework de madurez a utilizar",
            "example": "550e8400-e29b-41d4-a716-446655440002"
          },
          "startDate": {
            "type": "string",
            "description": "Fecha de inicio planificada",
            "example": "2024-02-01"
          },
          "endDate": {
            "type": "string",
            "description": "Fecha de fin planificada",
            "example": "2024-02-28"
          }
        }
      },
      "CreateRevisionDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Nombre descriptivo de la revisión (opcional). Si no se proporciona, se genera automáticamente.",
            "example": "Auditoría ISO 27001 - Empresa XYZ Q2 2024 (Revisión 1)",
            "minLength": 3,
            "maxLength": 255
          },
          "description": {
            "type": "string",
            "description": "Descripción de la revisión (opcional)",
            "example": "Segunda evaluación de seguimiento de hallazgos anteriores"
          },
          "startDate": {
            "type": "string",
            "description": "Fecha de inicio planificada para la revisión (opcional)",
            "example": "2024-05-01"
          },
          "endDate": {
            "type": "string",
            "description": "Fecha de fin planificada para la revisión (opcional)",
            "example": "2024-05-15"
          },
          "frameworkId": {
            "type": "string",
            "description": "ID del framework de madurez (opcional). Si no se proporciona, hereda del padre.",
            "example": "550e8400-e29b-41d4-a716-446655440002"
          }
        }
      },
      "AuditAssignmentResponseDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "auditId": {
            "type": "string",
            "example": "550e8400-e29b-41d4-a716-446655440001"
          },
          "userId": {
            "type": "string",
            "example": "550e8400-e29b-41d4-a716-446655440002"
          },
          "role": {
            "type": "string",
            "enum": [
              "LEAD_AUDITOR",
              "AUDITOR",
              "AUDITEE",
              "OBSERVER"
            ],
            "example": "LEAD_AUDITOR"
          },
          "assignedStandardIds": {
            "example": [
              "550e8400-e29b-41d4-a716-446655440003",
              "550e8400-e29b-41d4-a716-446655440004"
            ],
            "nullable": true,
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "notes": {
            "type": "object",
            "example": "Responsable de sección A.5",
            "nullable": true
          },
          "isActive": {
            "type": "boolean",
            "example": true
          },
          "createdAt": {
            "format": "date-time",
            "type": "string",
            "example": "2024-01-15T10:30:00.000Z"
          },
          "updatedAt": {
            "format": "date-time",
            "type": "string",
            "example": "2024-01-15T10:30:00.000Z"
          },
          "createdBy": {
            "type": "object",
            "example": "550e8400-e29b-41d4-a716-446655440005",
            "nullable": true
          },
          "updatedBy": {
            "type": "object",
            "example": "550e8400-e29b-41d4-a716-446655440005",
            "nullable": true
          }
        },
        "required": [
          "id",
          "auditId",
          "userId",
          "role",
          "assignedStandardIds",
          "notes",
          "isActive",
          "createdAt",
          "updatedAt",
          "createdBy",
          "updatedBy"
        ]
      },
      "AssignMemberDto": {
        "type": "object",
        "properties": {
          "userId": {
            "type": "string",
            "description": "ID del usuario a asignar",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "role": {
            "type": "string",
            "description": "Rol del miembro en la auditoría",
            "enum": [
              "LEAD_AUDITOR",
              "AUDITOR",
              "AUDITEE",
              "OBSERVER"
            ],
            "example": "AUDITOR"
          },
          "assignedStandardIds": {
            "description": "IDs de estándares específicos asignados a este miembro (opcional). Si es null, tiene acceso a todos.",
            "example": [
              "550e8400-e29b-41d4-a716-446655440001",
              "550e8400-e29b-41d4-a716-446655440002"
            ],
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "notes": {
            "type": "string",
            "description": "Notas sobre la asignación (ej: \"Responsable de sección A.5\")",
            "example": "Experto en controles de acceso"
          }
        },
        "required": [
          "userId",
          "role"
        ]
      },
      "NavigationItemDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "ID único del item (solo para navegación dinámica, ej: ID de plantilla)",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "title": {
            "type": "string",
            "description": "Título del item del menú",
            "example": "ISO 27001"
          },
          "description": {
            "type": "string",
            "description": "Descripción del item",
            "example": "Norma de seguridad de la información"
          },
          "url": {
            "type": "string",
            "description": "URL/ruta del item",
            "example": "/templates/550e8400-e29b-41d4-a716-446655440000"
          },
          "icon": {
            "type": "string",
            "description": "Icono del item",
            "example": "file-text"
          },
          "items": {
            "description": "Items hijos (para menús multinivel)",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NavigationItemDto"
            }
          },
          "badge": {
            "type": "string",
            "description": "Badge/contador (ej: notificaciones pendientes)",
            "example": "5"
          },
          "type": {
            "type": "string",
            "description": "Tipo de item",
            "enum": [
              "static",
              "dynamic"
            ],
            "example": "static"
          },
          "disabled": {
            "type": "boolean",
            "description": "Si el item está deshabilitado",
            "example": false
          },
          "order": {
            "type": "number",
            "description": "Orden de visualización",
            "example": 1
          }
        },
        "required": [
          "title",
          "url"
        ]
      },
      "MenuResponseDto": {
        "type": "object",
        "properties": {
          "navMain": {
            "description": "Items del menú principal (combina navegación estática y dinámica)",
            "example": [
              {
                "title": "Home",
                "url": "/",
                "icon": "home"
              },
              {
                "title": "Usuarios",
                "url": "/admin/users",
                "icon": "users"
              },
              {
                "title": "Frameworks",
                "url": "/admin/frameworks",
                "icon": "layers"
              },
              {
                "title": "Plantillas",
                "url": "/admin/templates",
                "icon": "folder"
              },
              {
                "title": "Controles",
                "url": "/admin/standards",
                "icon": "files",
                "items": [
                  {
                    "id": "550e8400-e29b-41d4-a716-446655440000",
                    "title": "ISO 27001",
                    "url": "/admin/templates/550e8400-e29b-41d4-a716-446655440000",
                    "icon": "file-text",
                    "badge": "1.0"
                  },
                  {
                    "id": "661e9511-f39c-52e5-b827-557766551111",
                    "title": "COBIT 5",
                    "url": "/admin/templates/661e9511-f39c-52e5-b827-557766551111",
                    "icon": "file-text",
                    "badge": "2.0"
                  }
                ]
              }
            ],
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NavigationItemDto"
            }
          }
        },
        "required": [
          "navMain"
        ]
      }
    }
  }
}