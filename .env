# ============================================
# APPLICATION SETTINGS
# ============================================
NODE_ENV=development
PORT=3000
APP_NAME="Audit Core"
APP_URL=http://localhost:3000

# ============================================
# DATABASE (PostgreSQL)
# ============================================
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/audit_core_db

# DB_HOST=localhost
# DB_PORT=5432
# DB_USERNAME=postgres
# DB_PASSWORD=postgres
# DB_DATABASE=audit_core_db

# ============================================
# LOGGING (Winston)
# ============================================
# Niveles: error | warn | info | http | verbose | debug | silly
# Recomendado: debug (desarrollo), http (staging), info (producción)
LOG_LEVEL=debug

# ============================================
# EMAIL (Ethereal para testing - Desarrollo)
# ============================================
# Para desarrollo usa Ethereal (emails de prueba)
# Genera credenciales en: https://ethereal.email/create
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_SECURE=false
MAIL_USER=nostemlucas@gmail.com
MAIL_PASSWORD=lchq izyk grvl urvm
MAIL_FROM=noreply@audit-core.com
MAIL_FROM_NAME="Audit Core"
TEST_EMAIL=nostemlucas@gmail.com

# ============================================
# JWT (Autenticación)
# ============================================
# Genera con: openssl rand -base64 32
# Access tokens: corta duración (15min) en Authorization header
# Refresh tokens: larga duración (7 días) en HTTP-only cookies
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRES_IN=15m

# Refresh Token
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-this-in-production
JWT_REFRESH_EXPIRES_IN=7d

# ============================================
# LOGIN RATE LIMITING
# ============================================
# Protección contra ataques de fuerza bruta en login
MAX_LOGIN_ATTEMPTS_IP=10
MAX_LOGIN_ATTEMPTS_USER=5
LOGIN_ATTEMPTS_WINDOW_MINUTES=15

# ============================================
# CORS (Cross-Origin Resource Sharing)
# ============================================
# Usa la URL exacta de tu frontend 
# Para múltiples orígenes separados por comas
CORS_ORIGIN=http://localhost:3000,http://localhost:8080,http://localhost:8081

# ============================================
# FILE UPLOADS
# ============================================
# Ruta donde se guardan los archivos subidos
UPLOAD_PATH=./uploads

# Tamaños máximos (en bytes)
MAX_FILE_SIZE=10485760
# 10MB = 10 * 1024 * 1024

# ============================================
# THROTTLING / RATE LIMITING
# ============================================
# Protección contra ataques de fuerza bruta
THROTTLE_TTL=60000  # 1 minuto en milisegundos
# Requests permitidos por TTL
THROTTLE_LIMIT=100

# ============================================
# PAGINATION
# ============================================
# Valores por defecto para paginación
DEFAULT_PAGE_SIZE=10
MAX_PAGE_SIZE=100

# ============================================
# SESSION / COOKIES
# ============================================
SESSION_SECRET=your-session-secret-change-this-in-production
SESSION_MAX_AGE=86400000
# 1 día en milisegundos (24 * 60 * 60 * 1000)

# ============================================
# SWAGGER / API DOCS
# ============================================
# Habilitar documentación Swagger
SWAGGER_ENABLED=true
# Ruta para acceder a Swagger
SWAGGER_PATH=api

# ============================================
# SECURITY
# ============================================
# Bcrypt rounds (más alto = más seguro pero más lento)
BCRYPT_ROUNDS=10

# ============================================
# FRONTEND URLS (para emails y redirects)
# ============================================
FRONTEND_URL=http://localhost:3000
FRONTEND_VERIFY_EMAIL_URL=http://localhost:3000/verify-email
FRONTEND_RESET_PASSWORD_URL=http://localhost:3000/reset-password

# ============================================
# REDIS (Cache y Sesiones)
# ============================================
# Redis para blacklist de tokens y almacenamiento de refresh tokens
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# ============================================
# RESET PASSWORD TOKENS (Híbrido: JWT + Redis)
# ============================================
RESET_PASSWORD_JWT_SECRET=yrst-swdfe
RESET_PASSWORD_TOKEN_EXPIRES_IN=1h

# Rate Limiting para Reset Password
MAX_RESET_PASSWORD_ATTEMPTS_EMAIL=10
RESET_PASSWORD_ATTEMPTS_WINDOW_MINUTES=60
TWO_FACTOR_RESEND_COOLDOWN_SECONDS=60
# ============================================
# TWO FACTOR AUTHENTICATION (2FA) (Híbrido: JWT + Redis)
# ============================================
TWO_FACTOR_CODE_LENGTH=6
TWO_FACTOR_CODE_EXPIRES_IN=5m
TWO_FACTOR_JWT_SECRET=0sJg87XCr7ZpkIdPQPAhL+vo4hifTtDlGnIQGakCE3o=

# Rate Limiting para 2FA
TWO_FACTOR_RESEND_COOLDOWN_SECONDS=60
TWO_FACTOR_VERIFY_MAX_ATTEMPTS=3
TWO_FACTOR_VERIFY_WINDOW_MINUTES=10

# ============================================
# DISPOSITIVOS CONFIABLES (Trusted Devices)
# ============================================
# Días de validez para dispositivos confiables (default: 90)
TRUSTED_DEVICE_TTL_DAYS=90

# Salt para generar fingerprint de dispositivo (REQUERIDO en producción)
# Generar con: openssl rand -base64 32
DEVICE_FINGERPRINT_SALT=qc2kzBht0/AYUTdQLrE6J624GpAod/5BWvRl000HPZU=

# ============================================
# TIMEZONE
# ============================================
TZ=America/La_Paz

UPLOADS_DIR=./uploads/

EMAIL_VERIFICATION_JWT_SECRET=your-email-verification-jwt-secret-change-this-in-production

# ============================================
# GOOGLE OAUTH (Autenticación con Google)
# ============================================
# Credenciales de Google Cloud Console
GOOGLE_CLIENT_ID=<>
GOOGLE_CLIENT_SECRET=<>
# Agrega /api antes de /auth
GOOGLE_CALLBACK_URL=http://localhost:3000/api/auth/google/callback
DEFAULT_ORGANIZATION_ID=0ccc4993-ca97-4608-b548-12463238eaea
